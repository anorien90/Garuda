<section class="space-y-4">
  <form id="entities-graph-form" class="grid gap-3 md:grid-cols-2 lg:grid-cols-3">
    <label class="space-y-1 text-sm font-medium text-slate-800 dark:text-slate-100">
      Query
      <input id="entities-graph-query" type="text" placeholder="e.g., semiconductor" class="w-full rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 p-2 text-sm">
    </label>
    <label class="space-y-1 text-sm font-medium text-slate-800 dark:text-slate-100">
      Entity Type
      <select id="entities-graph-type" class="w-full rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 p-2 text-sm">
        <option value="">Any</option>
        <option value="person">Person</option>
        <option value="org">Organization</option>
        <option value="location">Location</option>
        <option value="product">Product</option>
      </select>
    </label>
    <label class="space-y-1 text-sm font-medium text-slate-800 dark:text-slate-100">
      Min Score
      <input id="entities-graph-min-score" type="number" min="0" max="1" step="0.05" value="0.2" class="w-full rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 p-2 text-sm">
    </label>
    <label class="space-y-1 text-sm font-medium text-slate-800 dark:text-slate-100">
      Limit
      <select id="entities-graph-limit" class="w-full rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 p-2 text-sm">
        <option value="50">50</option>
        <option value="100" selected>100</option>
        <option value="200">200</option>
      </select>
    </label>
    <label class="space-y-1 text-sm font-medium text-slate-800 dark:text-slate-100">
      Neighbor Depth
      <select id="entities-graph-depth" class="w-full rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 p-2 text-sm">
        <option value="0">0 (seeds only)</option>
        <option value="1" selected>1 hop</option>
        <option value="2">2 hops</option>
        <option value="3">3 hops</option>
        <option value="99">Unlimited</option>
      </select>
    </label>
    <div class="flex items-end gap-2">
      <button id="entities-graph-load" type="submit" class="inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2 text-sm font-semibold text-slate-800 dark:text-slate-100 hover:border-brand-400 dark:hover:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-1 focus:ring-offset-slate-50 dark:focus:ring-offset-slate-900">
        Load graph
      </button>
      <button id="entities-graph-toggle3d" type="button" class="inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-xs font-semibold text-slate-800 dark:text-slate-100">
        Switch to 3D
      </button>
    </div>
    <div id="entities-graph-status" class="text-xs text-slate-500 dark:text-slate-300" aria-live="polite"></div>
  </form>

  <!-- Deep RAG Graph Exploration Controls -->
  <div class="grid gap-3 md:grid-cols-2 lg:grid-cols-3 p-3 rounded-lg border-2 border-brand-300 dark:border-brand-700 bg-brand-50/30 dark:bg-brand-900/10">
    <div class="lg:col-span-3">
      <div class="text-sm font-semibold text-brand-700 dark:text-brand-300 mb-2">ðŸš€ Deep RAG Graph Exploration</div>
    </div>
    
    <!-- Semantic Entity Search -->
    <div class="space-y-2">
      <label class="text-xs font-medium text-slate-700 dark:text-slate-200">Semantic Entity Search</label>
      <div class="flex gap-2">
        <input id="graph-semantic-search" type="text" placeholder="Search entities..." 
               class="flex-1 rounded-lg border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-2 text-sm">
        <button id="graph-semantic-search-btn" type="button"
                class="px-3 py-2 rounded-lg bg-brand-500 text-white text-xs font-semibold hover:bg-brand-600">
          Search
        </button>
      </div>
      <div class="flex gap-2 text-xs">
        <input id="graph-semantic-threshold" type="number" min="0" max="1" step="0.05" value="0.7" 
               class="w-20 rounded border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1 text-xs">
        <span class="text-slate-500 self-center">threshold</span>
      </div>
    </div>

    <!-- Graph Traversal -->
    <div class="space-y-2">
      <label class="text-xs font-medium text-slate-700 dark:text-slate-200">Graph Traversal</label>
      <button id="graph-traverse-btn" type="button" disabled
              class="w-full px-3 py-2 rounded-lg bg-purple-500 text-white text-xs font-semibold hover:bg-purple-600 disabled:bg-slate-300 disabled:cursor-not-allowed">
        Traverse from Selected
      </button>
      <div class="flex gap-2 text-xs">
        <label class="flex-1">
          <span class="text-slate-600 dark:text-slate-400">Max Depth</span>
          <input id="graph-traverse-depth" type="number" min="1" max="5" value="2" 
                 class="w-full rounded border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1 text-xs">
        </label>
        <label class="flex-1">
          <span class="text-slate-600 dark:text-slate-400">Top N</span>
          <input id="graph-traverse-topn" type="number" min="5" max="50" value="10" 
                 class="w-full rounded border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-1 text-xs">
        </label>
      </div>
    </div>

    <!-- Path Finding -->
    <div class="space-y-2">
      <label class="text-xs font-medium text-slate-700 dark:text-slate-200">Find Path Between Entities</label>
      <button id="graph-path-btn" type="button" disabled
              class="w-full px-3 py-2 rounded-lg bg-cyan-500 text-white text-xs font-semibold hover:bg-cyan-600 disabled:bg-slate-300 disabled:cursor-not-allowed">
        Find Path
      </button>
      <div class="text-xs text-slate-500">
        <span id="graph-path-status">Select 2 nodes to find path</span>
      </div>
    </div>
  </div>

  <div class="grid gap-3 md:grid-cols-2 lg:grid-cols-4">
    <div class="space-y-3 p-3 rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50/70 dark:bg-slate-900/50">
      <div class="text-xs uppercase tracking-wide text-slate-500">Node Filters</div>
      <div class="flex flex-wrap gap-2 text-xs">
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="entity" checked>Entity</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="person" checked>Person</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="org" checked>Org</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="location" checked>Location</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="product" checked>Product</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="page" checked>Page</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="intel" checked>Intel</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="image" checked>Image</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-node-filter" value="media" checked>Media</label>
      </div>
      <div class="text-xs uppercase tracking-wide text-slate-500">Edge Filters</div>
      <div class="flex flex-wrap gap-2 text-xs">
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="relationship" checked>Relationships</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="cooccurrence" checked>Co-occurrence</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="page-mentions" checked>Pageâ†’Entity</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="intel-mentions" checked>Intelâ†’Entity</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="intel-primary" checked>Intelâ†’Primary</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="page-image" checked>Pageâ†’Image</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="page-media" checked>Pageâ†’Media</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="entity-media" checked>Entityâ†’Media</label>
        <label class="inline-flex items-center gap-1"><input type="checkbox" class="entities-edge-filter" value="link" checked>Page links</label>
      </div>
      <div class="text-xs text-slate-500">Depth applies after filters; seeds are query matches (label/id) or all nodes if no query.</div>
    </div>

    <div class="lg:col-span-3 space-y-3">
      <div id="entities-graph-canvas" class="w-full h-[540px] rounded-lg border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900"></div>
      <div id="entities-graph-legend" class="mt-1 text-xs text-slate-500 dark:text-slate-300"></div>
      <aside id="entities-graph-details" class="text-sm space-y-2 p-3 rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50/60 dark:bg-slate-900/40">
        <div class="text-xs uppercase tracking-wide text-slate-500">Details</div>
        <div class="text-slate-700 dark:text-slate-100">Select a node to see details.</div>
      </aside>
    </div>
  </div>
</section>
